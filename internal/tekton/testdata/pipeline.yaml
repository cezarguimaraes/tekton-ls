apiVersion: tekton.dev/v1 # or tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: pipeline
spec:
  workspaces:
    - name: source
  tasks:
    - name: gen-code
      taskRef:
        name: gen-code
      workspaces:
        - name: source
          workspace: source
    - name: gen-code-2
      taskRef:
        name: gen-code
      runAfter:
        - gen-code
      workspaces:
        - name: source
          workspace: source
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: gen-code
spec:
  parameters:
  - name: param
  results:
  - name: foo
  workspaces:
  - name: source
  steps:
    - name: example
      image: busybox
      env:
      - name: FOO
        value: $(params.param)
      script: |
        #!/bin/sh
        echo $FOO > $(results.foo.path)

